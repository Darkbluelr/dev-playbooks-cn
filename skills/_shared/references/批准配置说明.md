# æ‰¹å‡†é…ç½®è¯´æ˜

> æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•é…ç½®æ‰¹å‡†æœºåˆ¶ï¼ŒåŒ…æ‹¬é»˜è®¤æ‰¹å‡†ã€è¶…æ—¶æ—¶é—´ç­‰ã€‚

## é…ç½®æ–‡ä»¶ä½ç½®

```
.devbooks/config.yaml
```

## é…ç½®ç¤ºä¾‹

```yaml
# æ‰¹å‡†é…ç½®
approval:
  # é»˜è®¤æ‰¹å‡†ç­–ç•¥
  # - auto_approve: è¶…æ—¶åè‡ªåŠ¨æ‰¹å‡†ï¼ˆé»˜è®¤ï¼‰
  # - require_explicit: å¿…é¡»æ˜ç¡®æ‰¹å‡†
  # - disabled: ç¦ç”¨æ‰¹å‡†æœºåˆ¶
  default_strategy: auto_approve

  # è¶…æ—¶æ—¶é—´ï¼ˆå°æ—¶ï¼‰
  timeout:
    proposal: 48      # Proposal éœ€è¦ 48 å°æ—¶
    design: 24        # Design éœ€è¦ 24 å°æ—¶
    tasks: 24         # Tasks éœ€è¦ 24 å°æ—¶
    verification: 12  # Verification éœ€è¦ 12 å°æ—¶

  # æ˜¯å¦éœ€è¦æ˜ç¡®æ‰¹å‡†
  require_explicit:
    proposal: true    # Proposal å¿…é¡»æ˜ç¡®æ‰¹å‡†
    design: false     # Design å¯ä»¥è‡ªåŠ¨æ‰¹å‡†
    tasks: false      # Tasks å¯ä»¥è‡ªåŠ¨æ‰¹å‡†
    verification: false  # Verification å¯ä»¥è‡ªåŠ¨æ‰¹å‡†

  # æ‰¹å‡†æ–¹å¼
  approval_methods:
    - cli           # å‘½ä»¤è¡Œæ‰¹å‡†
    - chat          # èŠå¤©æ‰¹å‡†
    - auto          # è‡ªåŠ¨æ‰¹å‡†

  # é€šçŸ¥æ–¹å¼
  notification:
    - terminal      # ç»ˆç«¯é€šçŸ¥
    # - desktop     # æ¡Œé¢é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
    # - email       # é‚®ä»¶é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
```

## é…ç½®è¯´æ˜

### 1. é»˜è®¤æ‰¹å‡†ç­–ç•¥

| ç­–ç•¥ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `auto_approve` | è¶…æ—¶åè‡ªåŠ¨æ‰¹å‡† | å¤§éƒ¨åˆ†æƒ…å†µï¼ˆæ¨èï¼‰ |
| `require_explicit` | å¿…é¡»æ˜ç¡®æ‰¹å‡† | é«˜é£é™©é¡¹ç›® |
| `disabled` | ç¦ç”¨æ‰¹å‡†æœºåˆ¶ | å®Œå…¨ä¿¡ä»» AI |

### 2. è¶…æ—¶æ—¶é—´

- **Proposal**ï¼š48 å°æ—¶ï¼ˆéœ€è¦æ›´å¤šæ—¶é—´æ€è€ƒï¼‰
- **Design**ï¼š24 å°æ—¶ï¼ˆæŠ€æœ¯ç»†èŠ‚ï¼‰
- **Tasks**ï¼š24 å°æ—¶ï¼ˆä»»åŠ¡æ‹†åˆ†ï¼‰
- **Verification**ï¼š12 å°æ—¶ï¼ˆéªŒæ”¶ç»“æœï¼‰

**å»ºè®®**ï¼š
- ä¸ªäººé¡¹ç›®ï¼šå¯ä»¥ç¼©çŸ­è¶…æ—¶æ—¶é—´ï¼ˆå¦‚ 12/6/6/3 å°æ—¶ï¼‰
- å›¢é˜Ÿé¡¹ç›®ï¼šä¿æŒé»˜è®¤è¶…æ—¶æ—¶é—´
- é«˜é£é™©é¡¹ç›®ï¼šå»¶é•¿è¶…æ—¶æ—¶é—´ï¼ˆå¦‚ 72/48/48/24 å°æ—¶ï¼‰

### 3. æ˜¯å¦éœ€è¦æ˜ç¡®æ‰¹å‡†

- **true**ï¼šå¿…é¡»æ˜ç¡®æ‰¹å‡†ï¼Œä¸ä¼šè‡ªåŠ¨æ‰¹å‡†
- **false**ï¼šè¶…æ—¶åè‡ªåŠ¨æ‰¹å‡†

**å»ºè®®**ï¼š
- Proposal è®¾ç½®ä¸º trueï¼ˆé‡è¦å†³ç­–ï¼‰
- å…¶ä»–é˜¶æ®µè®¾ç½®ä¸º falseï¼ˆå‡å°‘è´Ÿæ‹…ï¼‰

### 4. æ‰¹å‡†æ–¹å¼

#### CLI æ‰¹å‡†

```bash
# æ‰¹å‡†
devbooks approve <change-id> --stage proposal

# æ‹’ç»
devbooks reject <change-id> --stage proposal --reason "ç†ç”±"

# ä¿®æ”¹
devbooks revise <change-id> --stage proposal
```

#### èŠå¤©æ‰¹å‡†

ç›´æ¥åœ¨èŠå¤©ä¸­è¯´ï¼š
- "åŒæ„" / "æ‰¹å‡†" / "approve"
- "ä¸åŒæ„" / "æ‹’ç»" / "reject"
- "æˆ‘æƒ³ä¿®æ”¹ XXX"

#### è‡ªåŠ¨æ‰¹å‡†

è¶…æ—¶åè‡ªåŠ¨æ‰¹å‡†ï¼ˆæ ¹æ®é…ç½®ï¼‰

### 5. é€šçŸ¥æ–¹å¼

- **terminal**ï¼šç»ˆç«¯é€šçŸ¥ï¼ˆé»˜è®¤ï¼‰
- **desktop**ï¼šæ¡Œé¢é€šçŸ¥ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
- **email**ï¼šé‚®ä»¶é€šçŸ¥ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰

## æ‰¹å‡†æµç¨‹

### 1. åˆ›å»ºé˜¶æ®µ

AI åˆ›å»ºæ–‡æ¡£åï¼Œä¼šåœ¨æ–‡æ¡£æœ«å°¾æ·»åŠ æ‰¹å‡†åŒºå—ï¼š

```markdown
## âœ… æ‰¹å‡†æµç¨‹

**å½“å‰çŠ¶æ€**ï¼š
- ğŸ“ çŠ¶æ€ï¼šå¾…æ‰¹å‡†
- â° åˆ›å»ºæ—¶é—´ï¼š2026-01-19 10:00
- â° è¶…æ—¶æ—¶é—´ï¼š2026-01-20 10:00ï¼ˆ24 å°æ—¶åï¼‰

**å¦‚æœä½ åŒæ„**ï¼š
- [ ] âœ… æ‰¹å‡†ï¼Œå¼€å§‹ä¸‹ä¸€é˜¶æ®µ

**å¦‚æœä½ ä¸åŒæ„**ï¼š
- [ ] âŒ æ‹’ç»ï¼Œè¯´æ˜ç†ç”±

**é»˜è®¤é€‰æ‹©**ï¼šâœ… æ‰¹å‡†ï¼ˆ24 å°æ—¶åè‡ªåŠ¨æ‰¹å‡†ï¼‰
```

### 2. é€šçŸ¥é˜¶æ®µ

ç³»ç»Ÿä¼šé€šè¿‡é…ç½®çš„é€šçŸ¥æ–¹å¼æé†’ç”¨æˆ·ï¼š

```
â° æé†’ï¼šProposal å¾…æ‰¹å‡†
- å˜æ›´ï¼š20260119-1000-add-feature-x
- é˜¶æ®µï¼šProposal
- è¶…æ—¶æ—¶é—´ï¼š2026-01-20 10:00ï¼ˆè¿˜å‰© 23 å°æ—¶ï¼‰
- æ“ä½œï¼šdevbooks approve 20260119-1000-add-feature-x --stage proposal
```

### 3. æ‰¹å‡†é˜¶æ®µ

ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰¹å‡†ï¼š

- **CLI**ï¼š`devbooks approve <change-id> --stage proposal`
- **èŠå¤©**ï¼šç›´æ¥è¯´"åŒæ„"
- **è‡ªåŠ¨**ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œç­‰å¾…è¶…æ—¶

### 4. è¶…æ—¶é˜¶æ®µ

å¦‚æœè¶…æ—¶ä¸”é…ç½®ä¸º `auto_approve`ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‰¹å‡†ï¼š

```
âœ… è‡ªåŠ¨æ‰¹å‡†ï¼šProposal
- å˜æ›´ï¼š20260119-1000-add-feature-x
- é˜¶æ®µï¼šProposal
- åŸå› ï¼šè¶…æ—¶è‡ªåŠ¨æ‰¹å‡†ï¼ˆ24 å°æ—¶ï¼‰
```

### 5. è®°å½•é˜¶æ®µ

æ‰€æœ‰æ‰¹å‡†æ“ä½œéƒ½ä¼šè®°å½•åœ¨æ‰¹å‡†å†å²ä¸­ï¼š

```markdown
## æ‰¹å‡†å†å²

| æ—¶é—´ | é˜¶æ®µ | æ“ä½œ | æ“ä½œè€… | ç†ç”± |
|------|------|------|--------|------|
| 2026-01-19 10:00 | Proposal | åˆ›å»º | AI | - |
| 2026-01-20 10:00 | Proposal | è‡ªåŠ¨æ‰¹å‡† | ç³»ç»Ÿ | 24 å°æ—¶è¶…æ—¶ |
```

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ç¦ç”¨è‡ªåŠ¨æ‰¹å‡†ï¼Ÿ

ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```yaml
approval:
  default_strategy: require_explicit
  require_explicit:
    proposal: true
    design: true
    tasks: true
    verification: true
```

### Q2: å¦‚ä½•ç¼©çŸ­è¶…æ—¶æ—¶é—´ï¼Ÿ

ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```yaml
approval:
  timeout:
    proposal: 12
    design: 6
    tasks: 6
    verification: 3
```

### Q3: å¦‚ä½•æŸ¥çœ‹å¾…æ‰¹å‡†çš„å˜æ›´ï¼Ÿ

```bash
devbooks status
```

è¾“å‡ºï¼š

```
å¾…æ‰¹å‡†çš„å˜æ›´ï¼š
- 20260119-1000-add-feature-x (Proposal, è¿˜å‰© 23 å°æ—¶)
- 20260119-1100-fix-bug-y (Design, è¿˜å‰© 5 å°æ—¶)
```

### Q4: å¦‚ä½•æ‰¹é‡æ‰¹å‡†ï¼Ÿ

```bash
devbooks approve --all
```

### Q5: å¦‚ä½•æ’¤é”€æ‰¹å‡†ï¼Ÿ

```bash
devbooks revoke <change-id> --stage proposal
```

## æœ€ä½³å®è·µ

### 1. ä¸ªäººé¡¹ç›®

```yaml
approval:
  default_strategy: auto_approve
  timeout:
    proposal: 12
    design: 6
    tasks: 6
    verification: 3
  require_explicit:
    proposal: false
    design: false
    tasks: false
    verification: false
```

### 2. å›¢é˜Ÿé¡¹ç›®

```yaml
approval:
  default_strategy: auto_approve
  timeout:
    proposal: 48
    design: 24
    tasks: 24
    verification: 12
  require_explicit:
    proposal: true
    design: false
    tasks: false
    verification: false
```

### 3. é«˜é£é™©é¡¹ç›®

```yaml
approval:
  default_strategy: require_explicit
  timeout:
    proposal: 72
    design: 48
    tasks: 48
    verification: 24
  require_explicit:
    proposal: true
    design: true
    tasks: true
    verification: true
```
