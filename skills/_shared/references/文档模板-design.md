# Design 文档模板

> 本模板定义了 design.md 的标准结构，确保设计清晰、可实现、可验证。

## 文件位置

```
<change-root>/<change-id>/design.md
```

## 标准结构

```markdown
# <变更标题> - 设计文档

## 🎯 结论先行（30秒阅读）

**本设计会导致**：
- ✅ [会发生什么变化 1]
- ✅ [会发生什么变化 2]
- ✅ [会发生什么变化 3]

**本设计不会导致**：
- ❌ [不会发生什么 1]
- ❌ [不会发生什么 2]

**与 Proposal 的差异**：
- 📝 Proposal 说"[Proposal 的内容]"
- 🎨 Design 说"[Design 的具体实现方式]"

---

## 🤔 需求对齐检查（2分钟阅读）

> 目的：确认设计符合你的需求

### 快速检查

**Proposal 阶段你选择了**：
- 角色：[角色名称]
- 方案：[方案名称]

**Design 阶段的变化**：
- ⚠️ [发现的新问题或约束]
- ✅ [建议的调整]
- ⚠️ 代价：[说明代价]

**需要你确认**：
- [ ] ✅ 同意调整（[理由]）
- [ ] ❌ 不同意，继续原方案（[理由]）
- [ ] 🤔 我需要更多信息

**默认选择**：✅ 同意调整（24小时后自动批准）

---

## ✅ 批准流程（1分钟）

**当前状态**：
- 📝 状态：待批准
- ⏰ 创建时间：[时间]
- ⏰ 超时时间：[时间]（24小时后）

**如果你同意**：
- [ ] ✅ 批准设计，开始实现

**如果你不同意**：
- [ ] ❌ 拒绝设计，说明理由：[理由]

**默认选择**：✅ 批准设计（24小时后自动批准）

---

## 📋 详细设计（AI阅读）

### What（做什么）

#### 目标

[描述设计的目标]

#### 范围

[说明设计的范围]

---

### Constraints（约束条件）

#### 技术约束

| 约束 | 说明 | 影响 |
|------|------|------|
| [约束1] | [说明] | [影响] |

#### 业务约束

| 约束 | 说明 | 影响 |
|------|------|------|
| [约束1] | [说明] | [影响] |

---

### Architecture（架构设计）

#### 组件图

```
[使用 Mermaid 或文本描述组件关系]
```

#### 数据流

```
[描述数据流向]
```

#### 接口设计

| 接口 | 输入 | 输出 | 说明 |
|------|------|------|------|
| [接口1] | [输入] | [输出] | [说明] |

---

### Acceptance Criteria（验收标准）

#### AC-001: [验收标准标题]

**描述**：[一句话描述]

**验收条件**：
- [ ] [条件1]
- [ ] [条件2]

**测试方式**：[说明如何测试]

---

### Documentation Impact（文档影响）

#### 需要更新的文档

| 文档 | 更新原因 | 优先级 |
|------|----------|--------|
| [文档1] | [原因] | P0 |

#### 无需更新的文档

- [ ] 本次变更为内部重构，不影响用户可见功能
- [ ] 本次变更仅修复 bug，不引入新功

---

### Architecture Impact（架构影响）

#### 新增依赖

| 依赖 | 版本 | 用途 | 风险 |
|------|------|------|------|
| [依赖1] | [版本] | [用途] | [风险] |

#### 修改的模块

| 模块 | 修改类型 | 影响范围 |
|------|----------|----------|
| [模块1] | [新增/修改/删除] | [影响范围] |

---

## 批准历史

| 时间 | 阶段 | 操作 | 操作者 | 理由 |
|------|------|------|--------|------|
| [时间] | Design | 创建 | AI | - |
| [时间] | Design | 批准 | 用户 | [理由] |
```

## 使用指南

### 1. 结论先行的作用

- **30秒快速理解**：让用户立即知道设计的核心内容
- **与 Proposal 对比**：明确说明设计与提案的差异
- **降低认知负担**：用大白话，不用专业术语

### 2. 需求对齐检查的作用

- **轻量级对齐**：只在发现新问题或约束时才需要用户确认
- **快速决策**：大部分情况下用户只需要确认"同意"或"不同意"
- **保留控制权**：用户可以随时拒绝调整

### 3. 详细设计的作用

- **AI阅读**：提供完整的技术细节供AI参考
- **人类可跳过**：人类只需要读"结论先行"和"需求对齐检查"部分

### 4. 验收标准的作用

- **可测试**：每个验收标准都应该是可测试的
- **可追溯**：验收标准应该与 Proposal 的目标对应
- **可验证**：验收标准应该明确说明如何验证
