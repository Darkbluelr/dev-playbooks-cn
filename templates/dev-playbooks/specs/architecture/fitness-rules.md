# 适应度规则 (Fitness Rules)

> 本文档定义项目的架构适应度函数（Fitness Functions）。
> 这些规则用于自动验证架构约束的遵守情况。

---

## 什么是适应度函数？

适应度函数是可执行的架构约束检查。它们帮助团队：
- 自动化架构决策的验证
- 在 CI/CD 中持续检查架构健康
- 防止架构腐化

---

## 规则定义格式

```markdown
### FT-XXX: 规则名称

> 来源：<规则来源，如设计文档或架构决策>

**规则**：<规则描述>

**检查命令**：
\`\`\`bash
<检查命令>
\`\`\`

**严重程度**：Critical | High | Medium | Low
```

---

## 规则列表

### FT-001: 分层依赖方向

> 来源：架构设计

**规则**：上层可依赖下层，下层禁止依赖上层。

**检查命令**：
```bash
# 示例：检查 domain 层是否依赖 ui 层
grep -r "import.*from.*ui" src/domain/ && echo "FAIL" || echo "OK"
```

**严重程度**：Critical

---

### FT-002: 循环依赖禁止

> 来源：架构设计

**规则**：模块之间禁止循环依赖。

**检查命令**：
```bash
# 使用 madge 或类似工具检查
npx madge --circular src/
```

**严重程度**：High

---

### FT-003: 测试覆盖率

> 来源：质量要求

**规则**：单元测试覆盖率不低于 80%。

**检查命令**：
```bash
npm run test:coverage -- --coverage-threshold='{"global":{"lines":80}}'
```

**严重程度**：High

---

## 添加新规则的流程

1. 在变更包的 `design.md` 中提出新规则
2. 经过 Challenger 质疑和 Judge 裁决
3. 归档时将规则添加到本文档
4. 在 CI 中添加对应的检查脚本

---

**规则集版本**：v1.0.0
**最后更新**：{{DATE}}
