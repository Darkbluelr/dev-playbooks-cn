# .devbooks/config.yaml
# DevBooks Protocol Discovery Configuration
#
# 此文件由 DevBooks 自动生成，用于让 AI 自动发现项目配置。
# 请勿随意删除或修改，除非你清楚每个字段的含义。

# ==================== DevBooks 配置 ====================

# 根目录
root: dev-playbooks/

# 宪法文件（强制加载）
constitution: constitution.md

# 项目上下文
project: project.md

# 路径配置
paths:
  specs: specs/
  changes: changes/
  scripts: scripts/
  staged: specs/_staged/
  anti_patterns: specs/_meta/anti-patterns/

# ==================== 向后兼容配置 ====================

# 目录根映射（向后兼容）
truth_root: dev-playbooks/specs/
change_root: dev-playbooks/changes/

# 规则文档位置
agents_doc: dev-playbooks/project.md

# 项目画像（可选）
project_profile: dev-playbooks/specs/_meta/project-profile.md

# ==================== 协议约束 ====================

constraints:
  # apply 阶段是否必须指定角色
  apply_requires_role: true

  # apply 阶段可用角色
  apply_roles:
    - test-owner
    - coder
    - reviewer
    - test-reviewer

  # Test Owner 与 Coder 是否必须独立对话
  role_isolation: true

  # Coder 是否禁止修改 tests/
  coder_no_tests: true

  # 是否启用结构质量守门
  structural_guardrails: true

  # 是否强制加载宪法
  require_constitution: true

# ==================== 适应度函数配置 ====================

fitness:
  # 适应度检查模式：error（阻断）| warn（警告）| off（关闭）
  mode: warn

  # 规则文件路径
  rules_file: specs/architecture/fitness-rules.md

# ==================== AC 追溯配置 ====================

tracing:
  # AC 覆盖率阈值
  coverage_threshold: 80

  # 输出格式：text | json
  output_format: text

# ==================== 提案阶段配置 ====================

proposal:
  # 是否启用三角对辩（Author/Challenger/Judge）
  enable_debate: true

  # 是否需要 Impact Analysis（跨模块变更）
  require_impact_analysis: true

# ==================== AI Native Framework 扩展字段 ====================
#
# 说明：
# - 本段为可选扩展字段，未配置时不得改变既有工作流行为。
# - 这些字段由 `scripts/config-discovery.sh` 解析并输出（追加字段，不破坏 v2 固定字段顺序）。

# 闸门强度配置：light | standard | strict
gate_profile: standard

# 模型能力画像 ID（用于 Knife budget/slice_limits 推导）
model_profile: default

# 容量乘子（环境/工具增强），仅影响阈值，不改变闸门原则
model_capacity_factor: 1.0

# Knife 切片预算阈值集合（可为空；若为空则由 model_profile 推导或不启用超限裁判）
slice_limits: {}

# Void 协议开关（启用后允许 Freeze/Thaw）
void:
  enabled: false

# Extension Packs 配置（启用后将追加风险旗标/证据要求/附加检查项）
extensions:
  enabled_packs: []

# Brownfield 导入映射（只索引，不复制长文档）
# 可选：上游 SSOT 文档库根目录（只做索引与引用，禁止复制长文档原文进变更包）
# 例：truth_mapping: { ssot_root: "SSOT docs/" }
truth_mapping: {}

# 策略库→能力注入映射（建议以 ID 引用，避免在此处嵌入长文档）
skill_injection: []

# 平台同步目标（为空不影响行为；非空时 Start/Scaffold 触发平台工件同步）
platform_targets: []
