# 项目宪法 (Project Constitution)

> 本文档定义项目的不可违背原则（Global Inviolable Principles）。
> 所有 AI 助手和开发者在执行任何操作前必须遵守这些原则。

---

## Part Zero: 强制指令

**在执行任何 Skill 或操作之前，必须：**

1. 阅读并理解本宪法文档
2. 确认操作不违反任何 GIP 原则
3. 如有冲突，立即停止并报告

---

## 全局不可违背原则 (Global Inviolable Principles)

### GIP-01: 角色隔离原则

**规则**：Test Owner 与 Coder 必须在独立对话/独立实例中执行。

**理由**：
- 防止测试与实现之间的认知污染
- 确保 Red-Green 循环的完整性
- 避免"自己写测试自己改测试"的反模式

**违规后果**：变更包不可归档。

---

### GIP-02: 测试不可篡改原则

**规则**：Coder 角色禁止修改 `tests/**` 目录下的任何文件。

**理由**：
- 测试是规格的可执行形式
- 修改测试等于修改规格，需要设计层面决策
- 保证验收标准的独立性

**例外**：如需修改测试，必须交还 Test Owner 处理。

---

### GIP-03: 设计优先原则

**规则**：代码实现必须追溯到设计文档中的 AC-xxx。

**理由**：
- 确保所有代码变更有明确的业务目的
- 支持全程追溯：设计 → 任务 → 测试 → 代码
- 防止"幽灵功能"和无授权变更

**验证方式**：`ac-trace-check.sh` 检查覆盖率。

---

### GIP-04: 真理源唯一原则

**规则**：`specs/` 是系统行为的唯一真理源。

**理由**：
- 避免规格分散在多处导致不一致
- 确保所有角色参考同一来源
- 支持增量同步和冲突检测

**操作约束**：
- 变更包中的 spec delta 必须经过 stage → promote 流程
- 禁止直接修改 `specs/` 目录

---

## 逃生舱口 (Escape Hatches)

> 以下情况可临时绕过上述原则，但必须记录和追溯。

### EH-01: 紧急修复

**适用场景**：生产环境严重故障需要紧急修复。

**流程**：
1. 在 `evidence/` 中记录紧急修复原因
2. 标记 `[EMERGENCY]` 前缀
3. 事后补充完整的变更包

### EH-02: 原型验证

**适用场景**：技术方案不确定，需要快速验证。

**约束**：
- 代码必须放在 `prototype/` 目录
- 禁止直接合入生产代码
- 验证完成后通过正式流程提升

### EH-03: 人工裁决

**适用场景**：规则冲突或边缘情况需要人工判断。

**流程**：
1. 在 `proposal.md` 中记录决策点
2. 由项目负责人签字确认
3. 更新 Decision Log

---

## 宪法变更流程

1. 任何对本宪法的修改必须通过正式的变更提案
2. 变更提案需要经过 Challenger 质疑和 Judge 裁决
3. 宪法变更的优先级为 P0，需要所有核心成员确认

---

**宪法版本**：v1.0.0
**最后更新**：2026-01-11
