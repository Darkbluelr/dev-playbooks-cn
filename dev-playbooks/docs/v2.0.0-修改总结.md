# DevBooks v2.0.0 修改总结

> 本文档总结了 v2.0.0 版本的核心修改内容

## 修改背景

基于用户反馈和《协议 2026：AI 原生时代的认知兼容与人机通信标准》报告，我们对 DevBooks 的文档模板进行了重大改进，核心目标是：

1. **降低认知负担**：用大白话替代专业术语，让非技术人员也能理解
2. **结论先行**：每个文档顶部添加 30 秒快速摘要
3. **需求对齐**：挖掘用户的隐藏需求，提供多视角的推荐方案
4. **默认批准机制**：用户不说话 = 同意，减少决策疲劳
5. **项目级文档**：新增用户画像和决策日志

## 核心修改内容

### 1. 新增文档模板

在 `skills/_shared/references/` 目录下新增以下模板：

#### 1.1 文档模板-proposal.md

**核心结构**：
- 🎯 结论先行（30秒阅读）
  - 本提案会导致：[用大白话列出变化]
  - 本提案不会导致：[用大白话列出不变的事情]
  - 一句话总结

- 🤔 需求对齐（5分钟阅读）
  - 你是谁？（角色定位）
  - 你要什么？（核心需求）
  - 你可能没想到什么？（隐藏需求）
  - 基于你的选择，推荐方案

- ✅ 批准流程（1分钟）
  - 快速批准（推荐）
  - 默认选择：✅ 我同意推荐方案（24小时后自动批准）

- 📋 详细提案（AI阅读）
  - Why / What / Impact / Alternatives / Decision

- 批准历史

**关键特点**：
- 用大白话，假设用户是小白
- 提供多视角的推荐方案（快速上手者、平台构建者、快速验证者）
- 通过问题引导用户思考隐藏需求
- 默认批准机制，减少决策负担

#### 1.2 文档模板-design.md

**核心结构**：
- 🎯 结论先行（30秒阅读）
- 🤔 需求对齐检查（2分钟阅读）
  - 轻量级对齐，只在发现新问题时才需要用户确认
- ✅ 批准流程（1分钟）
- 📋 详细设计（AI阅读）

**关键特点**：
- 与 Proposal 对比，明确说明差异
- 轻量级需求对齐，减少重复
- 24小时后自动批准

#### 1.3 文档模板-tasks.md

**核心结构**：
- 🎯 结论先行（30秒阅读）
- ⚡ 快速批准（30秒）
  - 任务拆分概览
- ✅ 批准流程（1分钟）
- 📋 详细任务（AI阅读）
  - 主线计划 / 临时计划 / 断点区

**关键特点**：
- 快速批准，只需要确认任务拆分
- 24小时后自动批准

#### 1.4 文档模板-verification.md

**核心结构**：
- 🎯 结论先行（30秒阅读）
- ✅ 验收批准（30秒）
  - 测试结果概览
- ✅ 批准流程（1分钟）
- 📋 详细验证（AI阅读）

**关键特点**：
- 最快的批准流程
- 12小时后自动批准（比其他阶段更短）

#### 1.5 文档模板-project-profile.md

**核心结构**：
- 👤 你是谁？（角色定位）
- 🎯 你要什么？（核心需求）
  - 显性需求 / 隐藏需求
- 🚫 你不要什么？（边界条件）
- 🧭 你的北极星（长期目标）
- 📊 决策偏好（历史决策）
- 🔄 画像更新日志

**关键特点**：
- 记录用户画像，避免重复询问
- 记录隐藏需求，提供个性化推荐
- 记录决策偏好，确保决策一致性

#### 1.6 文档模板-decision-log.md

**核心结构**：
- 决策 #001：[决策标题]
  - 决策时间 / 决策阶段 / 决策者
  - 背景 / 选项 / 决策 / 理由 / 影响
  - 后续演变

**关键特点**：
- 记录所有重要决策
- 方便回溯和学习
- 避免重复讨论

#### 1.7 批准配置说明.md

**核心内容**：
- 批准配置示例（.devbooks/config.yaml）
- 配置说明（默认批准策略、超时时间、批准方式）
- 批准流程（创建、通知、批准、超时、记录）
- 常见问题
- 最佳实践（个人项目、团队项目、高风险项目）

**关键特点**：
- 可配置的批准机制
- 默认批准策略，减少决策负担
- 灵活的超时时间配置

### 2. 更新现有文档

#### 2.1 更新 proposal-author 的提案撰写提示词

**主要修改**：
- 添加对新模板的引用
- 要求按照新模板结构输出
- 强调用大白话，假设用户是小白
- 强调提供多视角的推荐方案
- 添加决策日志更新要求

**文件位置**：
`skills/devbooks-proposal-author/references/提案撰写提示词.md`

### 3. 核心设计原则

#### 3.1 结论先行（倒金字塔结构）

- **30秒快速理解**：让用户立即知道"会导致什么，不会导致什么"
- **降低认知负担**：用大白话，不用专业术语
- **建立预期**：明确说明变化范围

#### 3.2 需求对齐（挖掘隐藏需求）

- **角色定位**：帮助用户明确自己的角色和需求
- **隐藏需求挖掘**：通过问题引导用户思考可能忽略的需求
- **多视角推荐**：基于不同角色给出不同的推荐方案

#### 3.3 默认批准机制（减少决策疲劳）

- **用户不说话 = 同意**：超时后自动批准
- **降低决策负担**：大部分情况下用户不需要手动批准
- **保留控制权**：用户可以随时拒绝或自定义

#### 3.4 简化语言（假设用户是小白）

- **用大白话**：避免专业术语
- **用类比和举例**：降低理解门槛
- **用数字量化**：用数字说话

#### 3.5 项目级文档（知识沉淀）

- **用户画像**：记录用户的角色、需求、约束、偏好
- **决策日志**：记录所有重要决策，方便回溯和学习
- **避免重复**：避免重复询问相同的问题

## 实施计划

### Phase 1：核心功能（已完成）

- [x] 创建文档模板（proposal, design, tasks, verification）
- [x] 创建项目级文档模板（projectofile, decision-log）
- [x] 创建批准配置说明
- [x] 更新 proposal-author 的提案撰写提示词

### Phase 2：完整实施（待完成）

- [ ] 更新其他 skill 的提示词（design-doc, implementation-plan, test-owner）
- [ ] 实现批准机制的脚本（approve, reject, revise）
- [ ] 实现通知机制（terminal, desktop, email）
- [ ] 实现自动批准的定时任务

### Phase 3：英文版同步（待完成）

- [ ] 翻译所有新增的文档模板
- [ ] 同步到英文版项目（~/projects/dev-playbooks）

### Phase 4：发布（待完成）

- [ ] 更新版本号到 2.0.0
- [ ] 更新 CHANGELOG.md
- [ ] 发布到 npm
- [ ] 发布到 GitHub（创建 release）

## 破坏性变更

### 1. 文档结构变更

**影响**：
- 现有的 proposal.md 不符合新的结构
- 需要手动迁移或使用迁移脚本

**缓解措施**：
- 提供迁移脚本
- 保持向后兼容（旧格式仍然可以使用）

### 2. 批准机制变更

**影响**：
- 引入默认批准机制，可能不符合某些团队的流程

**缓解措施**：
- 可配置的批准策略
- 默认为 `auto_approve`，但可以改为 `require_explicit`

## 升级指南

### 1. 升级到 v2.0.0

```bash
# 更新 npm 包
npm install -g dev-playbooks@2.0.0

# 或者从 GitHub 更新
cd ~/projects/dev-playbooks-cn
git pull origin master
npm install
```

### 2. 迁移现有项目

```bash
# 运行迁移脚本（待实现）
devbooks migrate --from 1.x --to 2.0.0
```

### 3. 配置批准机制

在 `.devbooks/config.yaml` 中添加：

```yaml
approval:
  default_strategy: auto_approve
  timeout:
    proposal: 48
    design: 24
    tasks: 24
    verification: 12
  require_explicit:
    proposal: true
    design: false
    tasks: false
    verification: false
```

### 4. 创建项目级文档

```bash
# 创建用户画像
devbooks init-profile

# 创建决策日志
devbooks init-decision-log
```

## 常见问题

### Q1: 为什么要引入"结论先行"？

**A**: 因为 AI 生成的文档通常很长（上千行），人类没有时间阅读。"结论先行"让用户在 30 秒内了解核心内容，决定是否需要深入阅读。

### Q2: 为什么要用大白话？

**A**: 因为未来的开发者大部分都是小白，不是专业程序员。用大白话可以降低理解门槛，让更多人能够使用 DevBooks。

### Q3: 为什么要引入默认批准机制？

**A**: 因为要求用户对每个阶段都明确批准会导致决策疲劳。默认批准机制让用户只需要关注重要的决策，其他的自动通过。

### Q4: 如何禁用默认批准？

**A**: 在 `.devbooks/config.yaml` 中设置 `default_strategy: require_explicit`。

### Q5: 如何缩短超时时间？

**A**: 在 `.devbooks/config.yaml` 中修改 `timeout` 配置。

## 致谢

感谢用户提供的宝贵反馈和《协议 2026》报告的启发。

## 参考资料

- 《协议 2026：AI 原生时代的认知兼容与人机通信标准》
- 认知负荷理论（Cognitive Load Theory）
- 双系统理论（Dual Process Theory）
- 助推理论（Nudge Theory）
- 倒金字塔结构（Inverted Pyramid）
